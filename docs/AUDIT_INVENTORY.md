# Audit inventory

## Validator stack (KEEP)

| Name | Category | What it does | Who uses it today (evidence) | KEEP/LEGACY | Reason | Risk |
| --- | --- | --- | --- | --- | --- | --- |
| `crates/greentic-messaging-pack-validator` | validation | Builds the wasm component whose `world = greentic:pack-validate/pack-validator@0.1.0` is embedded inside the validator pack artifact (`crates/greentic-messaging-pack-validator/src/lib.rs`). | `scripts/build-validator-pack.sh` and the `push-validator` workflow compile this crate before templating the pack and uploading the `.gtpack` (`scripts/build-validator-pack.sh:28-81`, `.github/workflows/push-validator.yml:35-72`). | KEEP | The single compatibility gate cannot run without this component. | High |
| `validators/messaging` | pack publishing | Declares the `greentic.validators.messaging` pack/extension that points at the wasm validator and digest referenced by provider packs (`validators/messaging/pack.yaml:1-30`). | The build script stages this directory before running `greentic-pack build/doctor`, and `docs/pack-validation.md` documents it as the canonical validator world (`scripts/build-validator-pack.sh:22-81`, `docs/pack-validation.md:1-37`). | KEEP | Source of truth for the validator bundle that must be published. | High |
| `scripts/build-validator-component.sh` | pack publishing | Cross-compiles the validator crate for `wasm32-wasip2`, copies the wasm blob, and emits the digest JSON that feeds the pack bundle. | It is wrapped by `scripts/build-validator-pack.sh`, which is invoked by `ci/local_check.sh` and the `push-validator` workflow before `greentic-pack doctor` runs (`scripts/build-validator-pack.sh:28-81`, `ci/local_check.sh:263-275`, `.github/workflows/push-validator.yml:35-72`). | KEEP | Without this step the wasm artifact and digest cannot be produced. | High |
| `scripts/build-validator-pack.sh` | pack publishing | Templates the validator pack, injects the wasm component, runs `greentic-pack build/doctor`, and writes `dist/validators-messaging.gtpack`. | Called from `ci/local_check.sh` and the push-validator workflow that publishes the gate (`ci/local_check.sh:263-275`, `.github/workflows/push-validator.yml:35-72`). | KEEP | Packs+doctor pipeline would break if this script disappears. | High |
| `.github/workflows/push-validator.yml` | CI | Manual workflow that downloads greentic tools, runs the build scripts, resolves the workspace version, and pushes the validator `.gtpack` to GHCR (`.github/workflows/push-validator.yml:13-72`). | CI/publish automation is the only path that releases validator artifacts today. | KEEP | Needed to keep validator bundles in GHCR. | High |
| `docs/pack-validation.md` | documentation | Explains how providers declare `greentic.messaging.validators.v1` and pin `greentic:pack-validate/pack-validator@0.1.0`. | Provider authors and CI reference this doc when wiring the gate (`docs/pack-validation.md:1-37`). | KEEP | Source-of-truth for pack gating instructions. | Medium |
| `ci/local_check.sh` | CI | Local mirror of GH Actions that runs `greentic-messaging-test` followed by the validator pack build/doctor pipeline (`ci/local_check.sh:249-295`). | Documented as the pre-PR health check for the repo (`ci/README.md:1-9`), so contributors and automation hit the gate offline. | KEEP | Provides reproducible validation before pushing; removing it would leave a gap in checks. | Medium |

## Legacy runtime, tooling, and harnesses (LEGACY)

| Name | Category | What it does | Who uses it today (evidence) | KEEP/LEGACY | Reason | Risk |
| --- | --- | --- | --- | --- | --- | --- |
| `apps/messaging-gateway`, `apps/messaging-egress`, `apps/runner`, `apps/subscriptions-teams`, `apps/messaging-tenants`, `apps/cli-dlq`, `apps/slack_oauth`, `apps/ingress-common`, `apps/egress-common` | runtime | Binary entry points that glue `gsm-core`, `gsm-telemetry`, `gsm-dlq`, `greentic-secrets`, etc., into ingress/egress/runner/subscriptions/secrets helpers (`apps/messaging-gateway/src/main.rs:1-12`, `apps/messaging-egress/src/main.rs:1-7`, `apps/runner/src/main.rs:29-150`, `apps/subscriptions-teams/src/main.rs:1-9`, `apps/messaging-tenants/src/main.rs:1-210`, `apps/cli-dlq/Cargo.toml:1-15`, `apps/slack_oauth/src/main.rs:1-130`, `apps/ingress-common/Cargo.toml:1-24`, `apps/egress-common/Cargo.toml:1-20`). | Operator currently invokes these binaries when it brings up messaging stacks (`README.md:32-69`, `README.md:152-163`, `../greentic-operator/README.md:80-135`, `../greentic-operator/src/config.rs:345-368`, `../greentic-operator/src/services/messaging.rs:17-83`). | LEGACY | Operator is the new orchestrator and is expected to internalize this behavior; these binaries only exist for the legacy runtime. | Medium |
| `libs/core`, `libs/session`, `libs/translator`, `libs/security`, `libs/telemetry`, `libs/backpressure`, `libs/idempotency`, `libs/dlq`, `libs/testutil` | shared libs | Shared runtime primitives (card rendering, session storage, telemetry, backpressure/dlq helpers, translator/test utilities). | Only consumed by the legacy apps and CLI/harness (`crates/greentic-messaging-cli/Cargo.toml:12-26`, `crates/messaging-test/Cargo.toml:1-40`, `apps/runner/src/main.rs:15-200`, `apps/egress-common/Cargo.toml:13-20`). | LEGACY | No canonical external dependency beyond the deprecated runtime/CLI; operator rewrites most of this logic or consumes equivalent libs elsewhere. | Medium |
| `crates/greentic-messaging-cli`, `crates/messaging-test`, `crates/greentic-messaging-validate` | CLI + test harness | CLI orchestrator for dev messaging workflows plus the `messaging-test` harness and extra validators it ships. | Local developers run the CLI for `greentic-messaging serve/dev`, and providers/CI still run `greentic-messaging-test packs ... --dry-run` (`README.md:32-170`, `.github/workflows/messaging-test.yml:1-23`, `../greentic-messaging-providers/docs/ci_e2e.md:1-41`, `../greentic-messaging-providers/docs/ci_live_e2e.md:1-41`). | LEGACY | Not part of the canonical validator gate; `greentic-pack doctor` is the only required tool, so this harness is in the legacy bucket. | Medium |
| `tools/dev-viewer`, `tools/nats-demo`, `tools/mock-weather-tool`, `packs/messaging` | tooling | Preview/developer tools and pack sources that generate/describe provider adapters (`README.md:116-170`, `tools/dev-viewer/Cargo.toml`, `tools/nats-demo/Cargo.toml`, `tools/mock-weather-tool/Cargo.toml`, `packs/messaging/README.md:1-16`). | These targets are used only for local previews and developer boxes; provider pack generation has moved into `greentic-messaging-providers` (`packs/messaging/README.md:5-16`). | LEGACY | Developer-only artifacts that are being replaced by operator/packs repo workflows. | Low |
