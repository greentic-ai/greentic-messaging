---
id: PR-03
track: host
depends_on: [PR-02]
---
# PR-03: Add ProviderCapabilitiesV1 host types + validation (no runtime wiring yet)

## Goal
Define a stable, versioned capability model that any provider (installed from store) can declare, enabling generic planning.

## Changes
- Add `ProviderCapabilitiesV1` with conservative defaults
- Add `ProviderLimitsV1` nested struct (text length, payload bytes, actions, images, etc.)
- Add `validate_capabilities(&ProviderCapabilitiesV1) -> Result<(), CapError>` (soft/strict modes optional)

## Suggested location
- `crates/provider-common` if it already exists in this repo, otherwise:
- `crates/messaging-provider-contract/src/capabilities.rs` (new crate/module)

## Minimum fields
- `version: "v1"`
- `supports_adaptive_cards: bool`
- `supports_markdown: bool`
- `supports_html: bool`
- `supports_images: bool`
- `supports_buttons: bool`
- `supports_threads: bool`
- `max_text_len: Option<u32>`
- `max_payload_bytes: Option<u32>`
- `max_actions: Option<u32>`
- `max_buttons_per_row: Option<u32>`
- `max_total_buttons: Option<u32>`

## Acceptance criteria
- Unit tests: defaults, validation, serde round-trip
- No runtime behavior change
- No provider-specific branching added

## Notes
- This is your marketplace boundary: unknown providers must be representable here.
